package {import flash.display.MovieClip;import flash.events.Event;import flash.events.MouseEvent;import flash.filters.BitmapFilterQuality;import flash.filters.DropShadowFilter;import flash.net.URLRequest;import flash.media.Sound;import flash.media.SoundChannel;import flash.filesystem.File;import flash.desktop.NativeApplication;import flash.desktop.SystemIdleMode;public class Main extends MovieClip {  private var dropShadow:DropShadowFilter = new DropShadowFilter();  private var dropInnerShadow:DropShadowFilter = new DropShadowFilter();  private var playStatus:Boolean = false;  private var titleHeader = "Mellow Jingle ";  private var playList:Array = ["001", "002", "003", "004", "005", "006", "007", "008", "009", "010", "011", "012", "013", "014", "015", "016", "017", "018", "019", "020", "021", "022", "023", "024", "025", "026", "027", "028", "029", "030", "031", "032", "033"];  private var playIndex:int = 0;  private var soundLoader:Sound;  private var soundChannel:SoundChannel = new SoundChannel();		NativeApplication.nativeApplication.systemIdleMode=SystemIdleMode.KEEP_AWAKE;  public function Main() {    // constructor code    addEventListener(Event.ADDED_TO_STAGE, onAddedToStage);  }  private function onAddedToStage(e:Event) {    dropShadow.blurX = 60;    dropShadow.blurY = 60;    dropShadow.strength = 2.4;    dropShadow.quality = BitmapFilterQuality.HIGH;    dropShadow.angle = 270;    dropShadow.distance = 5;    dropShadow.color = 0xFFFFFF;    dropInnerShadow.blurX = 60;    dropInnerShadow.blurY = 60;    dropInnerShadow.strength = 2.4;    dropInnerShadow.quality = BitmapFilterQuality.HIGH;    dropInnerShadow.angle = 270;    dropInnerShadow.distance = 5;    dropInnerShadow.inner = true;    dropInnerShadow.color = 0xFFFFFF;    PlaySymbol.addEventListener(MouseEvent.MOUSE_DOWN, onPlaySymbolDown);    PlaySymbol.addEventListener(MouseEvent.MOUSE_UP, onPlaySymbolUp);    PlaySymbol.addEventListener(MouseEvent.RELEASE_OUTSIDE, onPlaySymbolUp);    PreviousSymbol.addEventListener(MouseEvent.MOUSE_DOWN, onPreviousSymbolDown);    PreviousSymbol.addEventListener(MouseEvent.MOUSE_UP, onPreviousSymbolUp);    PreviousSymbol.addEventListener(MouseEvent.RELEASE_OUTSIDE, onPreviousSymbolUp);		    NextSymbol.addEventListener(MouseEvent.MOUSE_DOWN, onNextSymbolDown);    NextSymbol.addEventListener(MouseEvent.MOUSE_UP, onNextSymbolUp);    NextSymbol.addEventListener(MouseEvent.RELEASE_OUTSIDE, onNextSymbolUp);    AboutSymbol.addEventListener(MouseEvent.MOUSE_DOWN, onAboutSymbolDown);    AboutSymbol.addEventListener(MouseEvent.MOUSE_UP, onAboutSymbolUp);		AboutSymbol.addEventListener(MouseEvent.RELEASE_OUTSIDE, onAboutSymbolUp);		    AboutFrame.addEventListener(MouseEvent.CLICK, onAboutFrameClick);    SaveSymbol.addEventListener(MouseEvent.CLICK, onSaveSymbolClick);    SaveFrame.addEventListener(MouseEvent.CLICK, onSaveFrameClick);				// touch-Disable pressed symbols		for each (var disabledSymbol in [AboutDownSymbol,PreviousDownSymbol]) {			disabledSymbol.mouseEnabled = false;			disabledSymbol.mouseChildren = false;		}				stage.addEventListener(Event.DEACTIVATE, onLeave);		stage.addEventListener(Event.ACTIVATE, onComeBack);		    setCurrentJingle();  }		private function onLeave(e:Event) {		trace("leave");	}	private function onComeBack(e:Event) {		trace("comeback");	}	  private function setCurrentJingle() {    var jinglePath = new URLRequest("./media/mp3_192/" + titleHeader + playList[playIndex] + ".mp3");    TrackNumber.text = playList[playIndex];    soundLoader = new Sound(jinglePath);  }  private function onPlaySymbolDown(e:MouseEvent) {    PlaySymbol.filters = [dropShadow, dropInnerShadow];    PauseSymbol.filters = [dropShadow, dropInnerShadow];  }  private function onPlaySymbolUp(e:MouseEvent) {    PlaySymbol.filters = [];    PauseSymbol.filters = [];    playStatus = !playStatus;    setPlayStatus();  }  private function onPreviousSymbolDown(e:MouseEvent) {		PreviousDownSymbol.visible = true;  }  private function onPreviousSymbolUp(e:MouseEvent) {		PreviousDownSymbol.visible = false;				if (e.type=="mouseUp") {			playStatus = true;			setPlayStatus();			playIndex = playIndex ? playIndex - 1 : playList.length - 1;			setCurrentJingle();			playCurrentTrack();		}  }  private function onNextSymbolDown(e:MouseEvent) {    NextSymbol.filters = [dropShadow, dropInnerShadow];  }  private function onNextSymbolUp(e:MouseEvent) {    NextSymbol.filters = [];    playStatus = true;    setPlayStatus();    playIndex = playIndex < playList.length - 1 ? playIndex + 1 : 0;    setCurrentJingle();    playCurrentTrack();  }  private function setPlayStatus() {    PlaySymbol.visible = !playStatus;    PauseSymbol.visible = playStatus;    if (playStatus) {      PlaySymbol.removeEventListener(MouseEvent.MOUSE_DOWN, onPlaySymbolDown);      PlaySymbol.removeEventListener(MouseEvent.MOUSE_UP, onPlaySymbolUp);      PauseSymbol.addEventListener(MouseEvent.MOUSE_DOWN, onPlaySymbolDown);      PauseSymbol.addEventListener(MouseEvent.MOUSE_UP, onPlaySymbolUp);      playCurrentTrack();    } else {      PlaySymbol.addEventListener(MouseEvent.MOUSE_DOWN, onPlaySymbolDown);      PlaySymbol.addEventListener(MouseEvent.MOUSE_UP, onPlaySymbolUp);      PauseSymbol.removeEventListener(MouseEvent.MOUSE_DOWN, onPlaySymbolDown);      PauseSymbol.removeEventListener(MouseEvent.MOUSE_UP, onPlaySymbolUp);      pauseCurrentTrack();    }  }  private function playCurrentTrack() {    if (playStatus) {      soundChannel.stop();      soundChannel = soundLoader.play(0);      soundChannel.addEventListener(Event.SOUND_COMPLETE, onSoundComplete);    } else {      soundChannel.stop();    }  }  private function pauseCurrentTrack() {    soundChannel.stop();  }  private function onSoundComplete(e:Event) {    playStatus = false;    setPlayStatus();  }  private function onAboutSymbolDown(e:Event) {		trace("down");    AboutDownSymbol.visible = true;  }  private function onAboutSymbolUp(e:MouseEvent) {		AboutDownSymbol.visible = false;		trace(e.type);		if (e.type=="mouseUp") {			AboutFrame.visible = true;		}  }	private function onAboutFrameClick(e:Event) {    AboutFrame.visible = false;  }  private function onSaveSymbolClick(e:Event) {    SaveFrame.visible = true;  }  private function onSaveFrameClick(e:Event) {    SaveFrame.visible = false;  }  private function onDownloadButtonClick(e:Event) {    var source:File = File.applicationDirectory.resolvePath("./media/m4r_64/" + titleHeader + playList[playIndex] + ".m4r");    var target:File = File.documentsDirectory.resolvePath(titleHeader + playList[playIndex] + ".m4r");    source.copyTo(target, true);    onSaveFrameClick(e);  }}}